{% extends 'base.html.twig' %}

{% block body %}
    <div class="container-fluid" style="background:gray;">

        <div class="row">
            <div class="col-12 text-center">
                <h1>The Map</h1>
            </div>
        </div>

        <div class="row">

             <div class="col-12 col-lg-7 text-centered">

                <div class="mapAsBackground constant-ratio relativeContainer" id="map">
                    {# for now, parameters in yml cannot be associative arrays,
                        so we were obliged to use an indexed one #}
                    <div style="position: absolute; top: {{ viewerPos[1] }}%; left: {{ viewerPos[0] }}%"
                        title="You are here!">
                        X
                    </div>

                    {% for element in attractionList %}
                        <div style="position: absolute;
                                top: {{ element.percentageY }}%; left: {{ element.percentageX }}%"
                                title="{{ element.shortDescription }}"
                                data-attraction-id="{{ element.id }}">
                            <img src="{{ element.imageUrl }}" class="attractionIcon"
                                alt="{{ element.name }}, {{ element.shortDescription }}"
                                title="{{ element.name }}, {{ element.shortDescription }}"
                            >
                            <div class="attractionCartridge">
                                <p class="attractionLabel">
                                    {{ element.name }}
                                </p>
                                <p class="attractionShort">
                                    {{ element.shortDescription }}
                                </p>
                            </div>
                        </div>

                    {% endfor %}
                </div>
             </div>

             <div class="col-12 col-lg-3 text-centered container-fluid bg-secondary">
                 {# the filter panel is shown here #}
{# TODO: the validation is off for now to allow sending empty input data,
 just get it back when a workaround is found!  #}
                  {{ form_start( filterQuery_form, { attr: {novalidate: 'novalidate'} } ) }}
                     {{ form_widget(filterQuery_form) }}
                  {#   <noscript>#}
                         <input type="submit" value="Envoyer RequÃªte" />
{#
                     </noscript>
#}
                 {{ form_end(filterQuery_form) }}
{# TODO: REMOVE THIS DEBUG #}
{{ dump(highlightList) }}

             </div>
        </div>

        <div class="row">
            <div class="col-12 col-lg-1 text-centered smallBeast">
                <img src="/images/entassement.png">
            </div>

            <div class="col-12 col-lg-4">
                <img class="bebete" src="/images/bestiole.png">
            </div>
        </div>

    </div>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="/css/map.css">
{% endblock %}

{% block javascript %}
    {{  parent() }}
    <script src="/js/ajax.js"></script>
    <script>
        highlightList = {{ highlightList | json_encode | raw }};
    </script>
    <script src="/js/mapPage.js"></script>
{% endblock %}
